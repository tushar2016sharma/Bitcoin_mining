---
title: "SPA"
author: "Kusum Sai Chowdary Sannapaneni"
date: "2023-10-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

library(sf)
library(ggplot2)
library(rnaturalearth)
library(plotly)
library(ggrepel)
library(scales)
```


```{r}
data <- read.csv("/Users/kusumsaichowdary/Downloads/regional_da.csv")

head(data)
```



```{r}


correlation <- cor(data$monthly_hashrate, data$gCO2e.kWh, method="pearson")
print(paste("Correlation between monthly hash rate and CO2 emissions: ", correlation))

```


#### The correlation between the monthly hash rate and co2 emmisions is 0.0873. 


#### This a very weak positive correlation between the two variables. It suggests that there isn’t a strong linear relationship between the region’s power consumption and their has rates. This means that regions with higher power consumption do not necessarily have a proportionally higher has rate


```{r}
data$carbon_footprint <- data$monthly_hashrate * data$gCO2e.kWh

carbon_footprint_by_region <- aggregate(carbon_footprint ~ country, data=data, sum)
carbon_footprint_by_region <- carbon_footprint_by_region[order(-carbon_footprint_by_region$carbon_footprint),]
print(head(carbon_footprint_by_region))

```


#### we are calculating carbon foot print with the mutlplication of monthly hasrate * c02


```{r}
carbon_footprint_by_region <- aggregate(carbon_footprint ~ country, data=data, sum)

ggplot(carbon_footprint_by_region, aes(x = reorder(country, carbon_footprint), y = carbon_footprint)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(x = "Country", y = "Total Carbon Footprint",
       title = "Carbon Footprint by Region") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

#### This metric represents the environmental impact in terms of carbon emissions resulting from bitcoin mining operations.

#### China has the highest cabon footprint which indicates a significant environmental impact from its bitcoin operations.


```{r}


avg_values <- aggregate(cbind(monthly_hashrate, gCO2e.kWh) ~ country, data=data, FUN=mean)


world <- ne_countries(scale = "medium", returnclass = "sf")
world_data_avg_hashrate <- merge(world, avg_values, by.x = "admin", by.y = "country", all.x = TRUE)

ggplot(data = world_data_avg_hashrate) +
  geom_sf(aes(fill = monthly_hashrate)) +
  scale_fill_gradient(name = "Average Monthly Hashrate", low = "blue", high = "darkblue") +
  theme_minimal() +
  labs(title = "Average Monthly Hashrate by Country")


world_data_avg_hashrate <- merge(world, avg_values, by.x = "admin", by.y = "country", all.x = TRUE)
world_data_avg_CO2 <- merge(world, avg_values, by.x = "admin", by.y = "country", all.x = TRUE)

ggplot(data = world_data_avg_hashrate) +
  geom_sf(aes(fill = monthly_hashrate)) +
  scale_fill_viridis_c(name = "Average Monthly Hashrate") +
  theme_minimal() +
  labs(title = "Average Monthly Hashrate by Country")



ggplot(data = world_data_avg_CO2) +
  geom_sf(aes(fill = gCO2e.kWh)) +
  scale_fill_gradient2(low = "red", mid = "darkblue", high = "red", midpoint = median(world_data_avg_CO2$gCO2e.kWh, na.rm = TRUE)) +
  theme_minimal() +
  labs(title = "Average CO2 Emissions by Country")

```



```{r}
data$date <- as.Date(data$date, format="%d/%m/%y")

p <- ggplot(data, aes(x = date, y = monthly_hashrate)) +
  geom_point(aes(color = country), size = 3) +
  facet_wrap(~ country, scales = "free_y") +
  scale_x_date(breaks = date_breaks("months"), labels = date_format("%b %Y")) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none") + 
  labs(
    x = "Date",
    y = "Average Monthly Hash Rate",
    title = "Monthly Average Hash Rate Change Over Time"
  )

print(p)

```


